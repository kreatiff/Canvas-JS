(()=>{"use strict";var e={d:(n,i)=>{for(var o in i)e.o(i,o)&&!e.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:i[o]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n)};function n(){return function(){const e=DpConfig.canvasRoles,n=ENV.current_user_roles;if(!e||!e.length)return!0;if(!n||!n.length)return!0;const o=n.filter((n=>e.includes(n)));return i("user roles",n),i("roles in DpConfig",e),o.length>0}()&&function(){let e=DpConfig.canvasUsers;if(!e||!e.length)return!0;const n=ENV.current_user.id;return e=Array.isArray(e)?e:e.split(","),i("matching User ID ".concat(n,":"),e),e.includes(n)||e.includes(parseInt(n))}()&&function(){let e=[];if(DpConfig.specifiedAccounts&&DpConfig.specifiedAccounts.forEach((function(n){e=e.concat(n.accounts)})),!e||!e.length)return!0;const n=ENV.ACCOUNT_ID;return e=Array.isArray(e)?e:e.split(","),i("matching accountId ".concat(n,":"),e),e.includes(n)||e.includes(parseInt(n))}()&&function(){let e=DpConfig.canvasCourseIds;if(!e||!e.length)return!0;const n=function(){let e=function(){let e="";if(document.URL.indexOf("/assignments/syllabus")>-1)return"syllabus";if(document.URL.indexOf("/assignments/")>-1)e="assignment";else if(document.URL.indexOf("/discussion_topics/")>-1)e="discussion_topic";else{if(document.URL.indexOf("/quizzes/")>-1)return"quiz";if(document.URL.indexOf("/pages/")>-1||document.URL.indexOf("/wiki")>-1||void 0!==ENV.WIKI_PAGE)return"page"}if("assignment"===e&&document.URL.indexOf("/assignments/new")>-1)return"assignment_new";if("assignment"===e)return"assignment";if("discussion_topic"===e){if(ENV.DISCUSSION&&ENV.DISCUSSION.TOPIC&&ENV.DISCUSSION.TOPIC.IS_ANNOUNCEMENT)return"announcement";if(document.URL.indexOf("/discussion_topics/new")>-1)return"discussion_topic_new";if(document.URL.indexOf("/groups/")>-1)return"group_discussion";if(document.URL.indexOf("/edit")>-1)return"discussion_topic_edit"}return e}();if("syllabus"===e)return ENV.context_asset_string.split("_").pop();if("discussion_topic_new"===e||"discussion_topic_edit"===e)return ENV.CONTEXT_ID;if("group_discussion"===e){if(ENV.DISCUSSION.SEQUENCE&&ENV.DISCUSSION.SEQUENCE.COURSE_ID)return ENV.DISCUSSION.SEQUENCE.COURSE_ID;if(ENV.SEQUENCE.COURSE_ID)return ENV.SEQUENCE.COURSE_ID}return ENV.COURSE_ID?ENV.COURSE_ID:ENV.course_id}();return e=Array.isArray(e)?e:e.split(","),i("matching course ID ".concat(n,":"),e),e.includes(n)||e.includes(parseInt(n))}()}function i(e,n){location.search.includes("debug")&&(n?console.log(e,n):console.log(e))}function o(){t("start handleLtiTools"),DpConfig.hideLti&&(t("hiding LTI Tools"),$("#left-side").find('a:contains("Multi"):contains("Tool")').hide(),$("#nav_form").find('li:contains("Multi"):contains("Tool")').hide(),$("#context_external_tools_select").find('a:contains("Multi"):contains("Tool")').closest("li").hide(),$("#context_external_tools_select").find('a:contains("Upload"):contains("Embed")').closest("li").hide(),$(".tox-editor-header").length!==$(".dp-remove-uei").length&&($(".tox-editor-header").find('button[title*="Upload"][title*="Embed"][title*="Image"]').hide(),$('.tox-editor-header button[title="Apps"]').addClass("dp-remove-uei"),$(".dp-remove-uei").off("click").on("click",(function(){setTimeout((function(){$('div[title*="Upload"][title*="Embed"][title*="Image"]').hide(),$('div[title="View All"]').addClass("dp-remove-uei-popup"),$(".dp-remove-uei-popup").click((function(){setTimeout((function(){$('span[aria-label="Apps"]').find('span:contains("Upload"):contains("Embed Image")').closest("li").hide()}),500)}))}),500)})))),t("end handleLtiTools")}function t(e){location.search.includes("debug")&&console.log(e)}function s(e){location.search.includes("debug")&&console.log(e)}e.d({},{L:()=>b,w:()=>v});const c={canvas:{contentSelectors:[["#course_home_content"],["#wiki_page_show"],["#wiki_page_revisions"],["#discussion_topic"],["#content .discussion-redesign-layout"],[".discussions-v2__wrapper"],[".discussions-sort-button"],["#course_syllabus"],["#assignment_show"],[".tool_content_wrapper"],["#addGroup"],[".choose-quiz-engine"],["#quiz_show"],["#quiz-instructions"],["body.people"],[".collectionView",".new_page"]],contentPaths:[["/rubrics"]],editSelectors:[],editPaths:[["/pages/","/edit"],["/assignments/","/edit"],["/discussion_topics/","/edit"],["/quizzes/","/edit"],["/dev/editor"],["/assignments/","/new"],["/discussion_topics/","/new"]]}},a=DpConfig.toolsUri?Date.now():"2024.1",r="dpUseLegacy",d="dpLegacyFallback",u="defaultToLegacy",l="enableVersionSwitching";let f={},p=!1;function g(){let e=DpConfig.lms?DpConfig.lms:"canvas";f=c[e],b("start dpInit"),b("start loadDpScripts"),function(){const e=_(f.contentSelectors),n=S(f.contentPaths),i=ENV&&ENV.a2_student_view;return e||n&&!document.URL.includes("/pages/")||i}()?(function(){const e=U();E("".concat(e,"js/content.js?v=").concat(a)),console.log("Content scripts added.")}(),function(){const e=document.URL;if(e.includes("/pages/css-preview")&&!e.includes("/edit")){const e=U();E("".concat(e,"js/css_preview.js?v=").concat(a)),console.log("CSS preview script added.")}}(),window.hasOwnProperty("DT_variables")&&null!==DT_variables&&(b("loading legacy"),w())):function(){const e=_(f.editSelectors),n=S(f.editPaths);return window.location.href.includes("?quiz_lti")?(b("DES-1638: Remove DesignPLUS launch button for new quizzes"),!1):e||n}()&&(h()?(b("loading legacy"),w()):n()?v():m()),b("end loadDpScripts"),h()?n()||(b("User does not have edit access, hiding LTI tools."),o()):(s("start handleSpecifiedAccts"),DpConfig.specifiedAccounts&&(s("handling specified accounts"),DpConfig.specifiedAccounts.forEach((function(e){let n=ENV.ACCOUNT_ID;n&&e.accounts.includes(n)&&("Primary"===e.customizationsType?(DpConfig.templateCourse=e.customizationsCourseId,DpConfig.hideButton=void 0!==e.hideButton?e.hideButton:DpConfig.hideButton,DpConfig.hideLti=void 0!==e.hideLti?e.hideLti:DpConfig.hideLti,DpConfig.courseFormats=void 0!==e.courseFormats?e.courseFormats:DpConfig.courseFormats,DpConfig.canvasRoles=void 0!==e.canvasRoles?e.canvasRoles:DpConfig.canvasRoles,DpConfig.canvasUsers=void 0!==e.canvasUsers?e.canvasUsers:DpConfig.canvasUsers,DpConfig.canvasCourseIds=void 0!==e.canvasCourseIds?e.canvasCourseIds:DpConfig.canvasCourseIds,DpConfig.enableVersionSwitching=void 0!==e.enableVersionSwitching?e.enableVersionSwitching:DpConfig.enableVersionSwitching,!1===e.enableVersionSwitching?DpConfig.hideSwitching=!0:!0===e.enableVersionSwitching&&(DpConfig.hideSwitching=void 0!==e.hideSwitching?e.hideSwitching:DpConfig.hideSwitching)):"Extended"===e.customizationsType&&(DpConfig.extendedCourse=e.customizationsCourseId,DpConfig.extendedCourseIdentifer=e.identifier))}))),s("end handleSpecifiedAccts"),n()?(b("User has edit access"),setTimeout((function(){!function(){try{if(b("start handleAddPage"),document.URL.indexOf("/pages")>-1&&-1===document.URL.indexOf("/pages/")){let e=document.querySelector(".new_page"),n=document.querySelector(".collectionView");e&&n&&$(".new_page").on("click",(function(){v()}))}b("end handleAddPage")}catch(e){console.error(e)}}(),function(){let e=document.querySelector(".edit_syllabus_link");e&&e.addEventListener("click",(function(){let e=document.querySelector("#kl_tools_wrapper"),n=document.querySelector("#kl_launch_button");e||n||v()}))}()}),500)):(b("User does not have edit access."),o(),m())),b("end dpInit")}function h(){if(b("start useLegacy"),!window.hasOwnProperty("DT_variables")||null==DT_variables)return!1;if(DpConfig.specifiedAccounts){let e=ENV.ACCOUNT_ID;DpConfig.specifiedAccounts.forEach((function(n){n.accounts&&n.accounts.includes(e)&&(DpConfig[u]=n.legacyDefault)}))}return document.cookie.includes(r)?D()?document.cookie.split(";").find((e=>e.includes("".concat(r,"=")))).includes("=true"):(C(r,DpConfig[u]),DpConfig[u]):u in DpConfig?((D()||DpConfig[u])&&C(r,DpConfig[u]),"true"===DpConfig[u]||!0===DpConfig[u]):(b("end useLegacy"),!1)}function C(e,n,i){document.cookie="".concat(e,"=").concat(n,"; expires=Thu, 01 Jan 1970 00:00:00 UTC;"),document.cookie="".concat(e,"=").concat(n,"; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/"),document.cookie=i?"".concat(e,"=").concat(n,"; max-age=").concat(i,"; path=/"):"".concat(e,"=").concat(n,"; expires=Tue, 31 Dec 2024 00:00:00 UTC; path=/")}function m(){window.hasOwnProperty("DT_variables")&&null!==DT_variables?(console.log("You have not been granted access to the new DesignPLUS Sidebar. This page will instead load the legacy sidebar."),b("failed user access check - loading legacy"),C(d,"true",10),w()):(DpConfig.editorDisabled=!0,v())}function D(){return l in DpConfig&&!0===DpConfig[l]}function _(e){for(let n of e){let e=0;for(let i of n)document.querySelector(i)&&e++;if(e===n.length)return b("matching selectors",n),!0}return!1}function S(e){const n=document.URL;for(let i of e){let e=0;for(let o of i)n.includes(o)&&e++;if(e===i.length)return b("matching paths",i),!0}return!1}function v(){const e=U();E("".concat(e,"js/editor.js?v=").concat(a)),console.log("Edit script added.")}function U(){const e=location.href.includes(".beta.")?"beta.":"";return DpConfig.toolsUri?DpConfig.toolsUri:"https://".concat(e,"designplus.ciditools.com/")}function E(e){let n=document.createElement("script"),i=document.getElementsByTagName("script")[0];n.src=e,n.crossorigin="anonymous",i.parentNode.insertBefore(n,i),console.log("adding url: "+e)}function w(){p||"object"!=typeof DT_variables||(E(DT_variables.path+"js/master_controls.js?v="+a),p=!0)}function b(e,n){location.search.includes("debug")&&(n?console.log(e,n):console.log(e))}$((function(){$("body").hasClass("dp-js-loaded")?console.log("DesignPLUS stopped itself from loading duplicate JS.  Please remove the duplicate DesignPLUS Config code in your institution's JS file or contact support@cidilabs.com for assistance."):($("body").addClass("dp-js-loaded"),setTimeout(g,500))}))})();